<%- include("../partials/header.ejs") -%>
<%- include("../partials/navigation.ejs") -%>
<body>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<div class="container">
		
		<div class="col-lg-12 col-xl-12 text-center"  style="padding-top:120px;">
                <h1><%= course.name %></h1>
                <h3><%= instructor.name %></h3>
		</div>
		
        <div class="col-lg-12">
            <h2>The Posts<br><br></h2>
        </div>
        
        <div class="row col-lg-12 col-xl-12">
        
        <% posts.map(post => { %>
            
            <div class="col-xl-5 col-lg-5 col-md-12 col-12 card shadow" style="margin-right: 8%;margin-right: 8%; margin-bottom: 5%; margin-top: 5%;">
                <div class="card-content">
                <h3>
                    <b><br><%= post.title %></b>
                </h3>
                <img src="/<%= post.document %>" alt="<%= post.title %>" style="width: 70%;margin-left: auto; margin-right: auto; padding-bottom: 10px;">
                <p><%= post.description %></p>
                
                <% post.comments.map(comment => { %>
                    <div class="well well-sm">
                        <h6> + <%= comment.comment %><br><h7 class="text-muted">By <%= comment.user.name%></h7></h6>
                    </div>
                        
                    <% }); %>
                <form action="/post/add-comment" method="POST">
                    <div class="form-group">
                        <input type="text" name="comment" id="comment" class="form-control" placeholder="Your comment">
                    </div>

                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    <input type="hidden" name="courseId" value="<%= course._id %>">

                    <input type="hidden" name="postId" value="<%= post._id %>">
                    
                    <button type="submit" style="background:#2B4BEA; text-color:#ffffff" class="btn btn-block login-btn mb-4">Submit</button>

                </form>

                </div>
            </div>    
        <% }); %>

        </div>

        <div class="col-xl-12 col-lg-12 card shadow" style="padding-top:10px; padding-bottom:20px;margin-top: 10px; margin-bottom: 40px;">
            <% if(isAdmin) { %>
                <h2>Add a new Post(upload only .jpg .jpeg. or .png file)</h2>
              <div class="col-xl-3 col-lg-4">
                <form action="/admin/course/add-post" method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                
                        <input type="text" name="title" id="title" class="form-control" placeholder="Title of the Post" required>
                    </div>
                    <div class="form-group">
 
                        <input type="file" name="document" id="document" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <textarea name="description" id="description" cols="30" rows="10" placeholder="Description" required></textarea>
                    </div>
                    <div class="form-group">   
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                        <input type="hidden" name="courseId" value="<%= course._id %>">
                    </div>
                    
                    <button type="submit" style="background:#2B4BEA; text-color:#ffffff" class="btn btn-block login-btn mb-4">Submit</button>
                
                </form>
              </div>
            <% } %>
        </div>
    </div>
</body>

<%- include("../partials/javascript.ejs") -%>
<%- include("../partials/footer.ejs") -%>
